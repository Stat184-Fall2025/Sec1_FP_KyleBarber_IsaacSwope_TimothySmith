---
title: "NFL Data Analysis"
authors: 
  - name: Isaac Swope
  - name: Kyle Barber
  - name: Tim Smith
date: "Dec 3, 2025"
date_modified: "Dec 3, 2025"
execute:
  warning: false
  error: false
  echo: false
format:
  pdf:
    geometry: margin=1in
    cap-location: top
    fig-pos: H
    tbl-pos: H
csl: apa7.csl
bibliography: citations.bib
---

```{r}
#| label: Packages

#Tidyverse Coding Styling


library(tidyverse)
library(ggimage)
library(kableExtra)
library(patchwork)
library(ggpubr)

```

## Data Overview

```{r}
#| label: Importing Data

NFL_raw <- read.csv("nfl-team-statistics (1).csv")

```

We chose to use the National Football Team Statistics data from data.scorenetwork.org. This data set was created by Ron Yurko and was published on May 24th, 2023. This data sets contains various team statistics from the 1999 regular season to the 2022 regular season for all 32 NFL teams. In this data set a case is an individual NFL team during a specific regular season from 1999 to 2022. This data was collected through the nflreadr package in r. The data contains two categorical variables, team and season. It also contains 54 quantitative variables including offensive passing stats, offensive rushing stats, defensive stats, wins, losses, and much more. This data was produced in a free to use csv file found on the data.scorenetwork.org website, [@yurko_national_2023]. The data met all of the FAIR requirements as it was easily finadable and accessible. Also, the data was interoperable as all the data was in a csv file. Lastly, it was reproducible as we were able to work with it in R studio. The data also met all CARE principles. The data can be used by anyone to benefit data analysis. The data is accessible by anyone and free to use. Also, the data is responsible and ethical as the data is accurate and up to date.

```{r}
#| label: Adding East, West, North and South Conferences

NFC_East_data <- NFL_raw %>%
  filter(team %in% c("DAL", "NYG", "PHI", "WAS"))%>%
  mutate(Conf = 'NFC_East')

NFC_West_data <- NFL_raw %>%
  filter(team %in% c("LA", "SEA", "SF", "ARI"))%>%
  mutate(Conf = 'NFC_West')

NFC_North_data <- NFL_raw %>%
  filter(team %in% c("CHI", "GB", "DET", "MIN"))%>%
  mutate(Conf = 'NFC_North')

NFC_South_data <- NFL_raw %>%
  filter(team %in% c("TB", "CAR", "ATL", "NO"))%>%
  mutate(Conf = 'NFC_South')

AFC_East_data <- NFL_raw %>%
  filter(team %in% c("NE", "BUF", "MIA", "NYJ"))%>%
  mutate(Conf = 'AFC_East')

AFC_West_data <- NFL_raw %>%
  filter(team %in% c("DEN", "LAC", "KC", "LV"))%>%
  mutate(Conf = 'AFC_West')

AFC_North_data <- NFL_raw %>%
  filter(team %in% c("BAL", "PIT", "CIN", "CLE"))%>%
  mutate(Conf = 'AFC_North')

AFC_South_data <- NFL_raw %>%
  filter(team %in% c("JAX", "IND", "HOU", "TEN"))%>%
  mutate(Conf = 'AFC_South')

NFL_Clean <- bind_rows(NFC_East_data, NFC_North_data, NFC_South_data, NFC_West_data, AFC_East_data, AFC_South_data, AFC_North_data, AFC_West_data) %>%
  arrange(season, team)%>%
    separate_wider_delim(
    cols = 'Conf',
    delim = '_',
    names = c('Conf', 'Div')
  )

```

## Offensive and Defensive Association with Wins

### Scatterplot of Win associations

In @fig-Win-association the y-axis has the wins that range from 0 to 16 and a linear regression line that wins with four different variables. In Wins Compared to Offensive Pass Yards the x-axis is the Offensive Pass Yards that range from 1000 to 6000. There is a positive linear association between wins and offensive pass yards which shows that as teams pass for more yards in a season they tend to win more games. In Wins Compared to Offensive Run Yards the x-axis is offensive run yards that range from 1000 to 4000 yards. There is a slightly stronger positive linear association between offensive run yards per seasons and offensive pass yards. This leads us to believe that it is slightly more important for teams to focus on good run offense then pass offense. Wins Compared to Defensive Allowed Pass Yards has defensive allowed pass yards as the x-axis with a range of 2000 to 5000 yards. There is a slightly negative linear association between defensive allowed pass yards and team wins. In Wins Compared to Defensive Allowed Run Yards the x-axis is defensive allowed run yards with a range from 500 to 3000 yards. There is a relatively strong negative linear association between defensive run yards allowed and team wins in a season. This leads us to believe that it is much more important to focus on run defense than pass defense as that would lead to more wins. In @fig-Win-association the colors are sorted by AFC and NFC teams for all of the graphs. In @fig-Win-association it seems to be more important to focus on both run offense and run defense to lead to more wins. It is definitely more important to focus on run defense then it is to focus on pass defense. This could be because a strong game allows a team to control the clock and have more possession time then the other team as every run play uses the clock.

```{r, fig.height=5, fig.width=10}
#| label: fig-Win-association
#| fig-cap: "Win Association of Offensive and Defensive Pass Yards"
#| fig-alt: "Four scatter plots showing NFL data, with axes for wins and various yard metrics. Trend lines suggest correlations."

#author: Timothy Smith
#reviewed: Isaac Swope, Kyle Barber

plot1<-NFL_Clean%>%
  group_by(Div)%>%
ggplot(# Step 1: Create the first graph using ggplot and geom point with x as offense pass yards and y as wins with colors being conference----
    mapping = aes(
      x = offense_total_yards_gained_pass,
      y = wins,
      color = Conf
    )#Step 2: Make the points size 1 and the transparency to be .2 ----
  ) +
  geom_point(size = .6) +
  labs(#Step 3: add labels and title to the data visualization and create the colors for the points----
    x = "Offensive Pass Yards",
    y = "Wins",
    color = "Conference",
    title = "Wins Compared to Offensive Pass Yards"
  ) +
  scale_color_manual(
    values = c("red", "blue")
  )+
  theme_bw() +
  theme(
    legend.position = "bottom"
  )+
  geom_smooth(method = "lm", se = FALSE, color = "black") 
# Step 4: Create the regression line ----
  plot2<-NFL_Clean%>%
  group_by(Div)%>%
ggplot(# Step 5: Repeat Step 1 but x is the total rush yards----
    mapping = aes(
      x = offense_total_yards_gained_run,
      y = wins,
      color = Conf
    )#Step 6: repeat step 2 for the second plot ----
  ) +
  geom_point(size=.6) +
  labs(#Step 7: repeat step 3 for the second plot----
    x = "Offensive Run Yards",
    y = "Wins",
    color = "Conference",
    shape = "team",
    title = "Wins Compared to Offensive Run Yards"
  ) +
  scale_color_manual(
    values = c("red", "blue")
  )+
  theme_bw() +
  theme(
    legend.position = "bottom"
  )+
  geom_smooth(method = "lm", se = FALSE, color = "black") 
  #Step 8: Repeat step 4 for second plot----
  plot3<-NFL_Clean%>%
  group_by(Div)%>%
ggplot(#Step 9: Repeat step 1 but with x as the defensive allowed pass yards ----
    mapping = aes(
      x = defense_total_yards_gained_pass,
      y = wins,
      color = Conf
    )#Step 10: Repeat step 2 but for third plot----
  ) +
  geom_point(size=.6) +
  labs(#Step 11: repeat step 3 but for third plot----
    x = "Defensive Allowed Pass Yards",
    y = "Wins",
    color = "Conference",
    title = "Wins Compared to Defensive Allowed Pass Yards"
  ) +
  scale_color_manual(
    values = c("red", "blue")
  )+
  theme_bw() +
  theme(
    legend.position = "bottom"
  )+
  geom_smooth(method = "lm", se = FALSE, color = "black") 
  #Step 12: repeat step 4 but for third plot----

  plot4<-NFL_Clean%>%
  group_by(Div)%>%
ggplot(#Step 13: repeat step 1 but x is the allowed rush yards----
    mapping = aes(
      x = defense_total_yards_gained_run,
      y = wins,
      color = Conf
    )# Step 14: repeat step 2 but for fourth plot----
  ) +
  geom_point(size=.6) +
  labs(#Step 15: repeat step 3 but for fourth plot----
    x = "Defensive Allowed Run Yards",
    y = "Wins",
    color = "Conference",
    title = "Wins Compared to Defensive Allowed Run Yards"
  ) +
  scale_color_manual(
    values = c("red", "blue")
  )+
  theme_bw() +
  theme(
    legend.position = "bottom"
  )+
  geom_smooth(method = "lm", se = FALSE, color = "black") 
#Step 16: repeat step 4 but for fourth plot----
  
  ggarrange(plot1, plot2, plot3, plot4, nrow = 2, ncol = 2, common.legend = TRUE, legend = "bottom" )
  
#Step 17: create a grid with all of the plots together----


```

### Average Wins and Offensive and Defensive Yards Table

@tbl-O-D-Statistics includes the average team wins, the 32 NFL teams, average Offensive pass yards, average offensive rush yards, average defensive rush yards, and average defensive pass yards. The defensive statistics is the average amount of yards that the defense allowed so the lower the number the better the team is in that particular stat. The team with the most average wins in the patriots which makes sense as they had one of the biggest dynasties in NFL history. What is interesting about this is that they had the highest wins, but in every other category there was at least one team that performed better then them. The highest average offensive pass yards belonged to New Orleans which is 9th in the average wins statistic. The highest average rush yards belongs and lowest allowed rush yards belongs to Baltimore which is 5th in average wins. Buffalo has the lowest allowed pass yards and they are 17th in average wins. This shows that the best team is not the best in each category so it must be a combination of these things that lead to winning football. Cleveland does have the lowest average wins and lowest average allowed rush yards so there could be a stronger correlation with losing and have a bad rush defense which is also supported in @fig-Win-association.

```{r}
#| label: tbl-O-D-Statistics 
#| tbl-cap: "NFL Offensive and Defensive Statistics"

#author: Timothy Smith
#reviewed: Isaac Swope, Kyle Barber

NFL_O_D <- NFL_Clean %>%
  group_by(team)%>%
  summarize(#Step 1: Determine the average values of the 5 main statistics that I want to work on and arrange by the Average Team Wins----
    Mean_Wins = mean(wins, na.rm = TRUE),
    Mean_O_pass_yards = mean(offense_total_yards_gained_pass, na.rm = TRUE),
    Mean_O_run_yards = mean(offense_total_yards_gained_run, na.rm = TRUE),
    Mean_D_pass_yards = mean(defense_total_yards_gained_pass, na.rm = TRUE),
    Mean_D_run_yards = mean(defense_total_yards_gained_run, na.rm = TRUE)
  ) %>%
  arrange(desc(Mean_Wins))
    
    names(NFL_O_D) <- c(#Step 2: replace the Names of the columns----
    "Teams",
    "Average Wins",
    "Mean Offensive Pass Yards",
    "Mean Offense Run Yards",
    "Mean Defensive Pass Yards",
    "Mean Defensive Run Yards"
    )
  
NFL_O_D %>%
  kable(#Step 3: Create the table using the kable function----
    booktabs = TRUE,
    align = c("l", rep("c",10)),
    digits = 2,
    format.args = list(big.mark = ",")
  )

```

## Team Wins from 1999-2022

When people think of the best football team of all time, to many, the first thing to come to mind is wins. In this section we will look at a visualization and some statistics to build an understanding of team wins in the 21st century.

First we have simple bar charts @fig-team-wins showing every NFL team's total wins since from 1999-2022. The bar charts are separated and colored so one can more easily compare within divisions and across the conferences. Note the thin white lines, which show how the wins are summed up by season. An interesting observation is that it seams as though teams with more wins were also more consistent across seasons as the distance between white lines does not vary as much as those in teams with less overall wins. This is a observed trend which can be made by looking at the figure, but it will not be shown to be statistically significant in this section, whether or not it truly is.

```{r, fig.width=8}
#| label: fig-team-wins
#| fig-cap: "Barcharts of Team Wins"
#| fig-alt: "Grid of four barcharts showing total team wins separated by division"

#author: Isaac Swope
#reviewed: Kyle Barber

#we need to sum and order by wins so we use fct_reorder and then .desc=TRUE to force descending order.
ggplot(NFL_Clean) +
  aes(x = fct_reorder(team, wins, .fun=sum, .desc=TRUE), y = wins, fill = Conf) +
  geom_col(color = NA) +
  facet_wrap("Div", scales = "free") + #eliminate spacing between columns due to scale
  labs(y = "Wins", 
       x = "Teams",
       )
  
```

Now it would be appropriate to provide a table showing statistics for wins by season. The following table @tbl-win-stats gives seasons played from 1999-2022, minimum wins in a season, first quartile, median wins, third quartile, maximum wins in a season, simple arithmetic mean of wins, and standard deviation for each team. One thing to note is that Houston has played three seasons less than the other teams, as they joined the NFL in the 2002 season. Standard deviation represented by SD is the how much a team's amount of wins usually varies from season to season.

```{r}
#| label: tbl-win-stats
#| tbl-cap: "Team Wins Statistics"
#| html-table-processing: none

#author: Isaac Swope
#reviewed: Timothy Smith, Kyle Barber

winsTable <- NFL_Clean %>%
  group_by(team)%>% #we want to group by team
  summarize( # calculating the selected statistics
    Count=n(),
    Min = min(wins, na.rm = TRUE),
    Quartile_1 = quantile(wins, probs = 0.25, na.rm = TRUE),
    Median = median(wins, na.rm = TRUE),
    Quintile_3 = quantile(wins, probs = 0.75, na.rm = TRUE),
    Max = max(wins, na.rm = TRUE),
    Mean = mean(wins, na.rm = TRUE),
    SD = sd(wins, na.rm = TRUE),
  )%>%
  mutate(
    across(
      .cols = where(is.numeric),
      .fns = ~round(.x, digits = 2) #rounding to 2 decimal places
    )
  )

names(winsTable) <- c( #renaming columns
    "Team",
    "Seasons",
    "Minimum",
    "Quartile 1",
    "Median",
    "Quartile 3",
    "Max",
    "Mean",
    "SD"
    )
  
winsTable %>%
  kable(
    booktabs = TRUE,
    align = c("l", rep("c",10))
  )

```

## Team Efficiency

```{r}
#| label: fig-efficiency-scatter-plot
#| fig-cap: "NFL Team Efficiency Scatter Plot"
#| fig-alt: "Scatter plot of all NFL teams average points scored vs points allowed with effeciency line."
#| fig-pos: "H"

#Author: Kyle Barber
#reviewed: 

NFL_Clean_3 <- NFL_Clean %>% ## Wrangle data
  select(team, Conf, score_differential, points_scored,
         points_allowed, wins, losses) %>% ### Choose necessary columns
  group_by(team, Conf) %>%
  summarise(
    points_scored = mean(points_scored),
    points_allowed = mean(points_allowed),
    wins = mean(wins),
    losses = mean(losses),
    point_differential = mean(score_differential),
    .groups = "drop"
  ) ### Get the mean for each variable
NFL_Clean_3$logo <- paste0("Logos/", NFL_Clean_3$team, ".png") ### Add logo column

ggplot(NFL_Clean_3) + ## Make plot
  aes(x = points_allowed, y = points_scored) + ### Set aesthetic
  geom_point(size = 0.1) + ### Make scatter plot
  geom_image(aes(image = logo)) + ### add in images
  labs(
    x = "Points Allowed (per season)",
    y = "Points Scored (per season)"
  ) + ### Set x and y axis labels
  geom_abline(slope = 1, intercept = 0) + ### Add efficiency line
  theme_minimal() +
  facet_wrap(vars(Conf)) ### Separate plots by conference

```

@fig-efficiency-scatter-plot shows a scatter plot of each NFL team's efficiency by showing the relationship between a team's average points allowed per season (x-axis) vs average points scored per season (y-axis) from the 1999 NFL regular season to the 2022 NFL regular season. Each point on the graph represents an individual team average and differentiates the teams by team logo, [@noauthor_nfl_nodate]. The top left corner of the plot shows the most efficient teams. The bottom right corner of the plot shows the least efficient teams. The diagonal line in the middle of both plots demonstrates a efficiency threshold. If a team is above the line they are considered efficient. If a team is below the line they are considered inefficient. If a team is on the line they are neutral. The plot is broken up into two sides, one representing the AFC teams and the other representing the NFC teams.

```{r}
#| label: tbl-efficiency-AFC
#| tbl-cap: "AFC Efficiency Table"
#| tbl-alt: "Data table showing all AFC team's logo, average point differential, win rate, and loss rate."
#| tbl-pos: "H"

#Author: Kyle Barber
#Reviewed: 
  
AFC_table <- NFL_Clean_3%>% ## Clean data
  filter(Conf == 'AFC')%>% ### Choose necessary confrence
  select(team, point_differential, wins, losses, logo)%>% ### Choose necessary variables
  mutate(
    point_differential = round(point_differential, digits = 4),
    wins = round(wins, digits = 4),
    losses = round(losses, digits = 4),
    image = ""
  )%>% ### Round all numeric variables
  arrange(desc(wins)) %>% ### Arrange by descending win rate
  rename( ### Rename variables
    Team = team,
    `Average Point Differential` = point_differential,
    `Win Rate` = wins,
    `Loss Rate` = losses
  )

AFC_table %>% ## Make table
  select(Team, image, `Average Point Differential`, `Win Rate`, `Loss Rate`) %>%### Choose necessary variables to include
  kable( ### Set format
    booktabs = TRUE,
    align = c("l", rep("c", 10)),
    format = "latex"
  )%>%
  kable_paper()%>%
  column_spec(2, image = spec_image(path = AFC_table$logo, 50, 50)) ### Add images

```

```{r}
#| label: tbl-efficiency-NFC
#| tbl-cap: "NFC Efficiency Table"
#| tbl-alt: "Data table showing all NFC team's logo, average point differential, win rate, and loss rate."
#| tbl-pos: "H"

#Author: Kyle Barber
#Reviewed: 

NFC_table <- NFL_Clean_3%>% ## Clean data
  filter(Conf == 'NFC')%>% ### Choose necessary conference
  select(team, point_differential, wins, losses, logo)%>% ### Choose necessary variables
  mutate( ### round each numeric variable
    point_differential = round(point_differential, digits = 2),
    wins = round(wins, digits = 2),
    losses = round(losses, digits = 2),
    image = ""
  )%>%
  arrange(desc(wins)) %>% ### Arrange by win rate descending
  rename( ### Rename variables
    Team = team,
    `Average Point Differential` = point_differential,
    `Win Rate` = wins,
    `Loss Rate` = losses
  )

NFC_table %>% ## Make table
  select(Team, image, `Average Point Differential`, `Win Rate`, `Loss Rate`) %>% ### select necessary variables
  kable( ### Set format
    booktabs = TRUE,
    align = c("l", rep("c", 10)),
    format = "latex",
    col.names = c( ### Set column names
      "Team",
      "Logo",
      "Avg. Point Dif",
      "Win Rate",
      "Loss Rate"
    )
  )%>%
  kable_paper()%>%
  column_spec(2, image = spec_image(path = NFC_table$logo, 50, 50)) ### Add images

```

{{< pagebreak >}}
# Refrences
::: {#refs}
:::

{{< pagebreak >}} 
# Code Appendix

```{r codeAppend, ref.label=knitr::all_labels(), echo=TRUE, eval=FALSE}

```
