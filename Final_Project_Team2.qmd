---
title: "NFL_Data_Analysis"
authors: 
  - name: Isaac Swope
  - name: Kyle Barber
  - name: Tim Smith
date: "Dec 3, 2025"
date_modified: "Dec 3, 2025"
execute:
  warning: false
  error: false
  echo: false
format:
  pdf:
    geometry: margin=1in
    cap-location: top
    fig-pos: H
    tbl-pos: H
    
---

```{r}
#| label: Packages

#Tidyverse Coding Styling


library(tidyverse)
library(ggimage)
library(kableExtra)
library(patchwork)
library(ggpubr)

```

## Data Overview

```{r}
#| label: Importing Data

NFL_raw <- read.csv("nfl-team-statistics (1).csv")

```


```{r}
#| label: Adding East, West, North and South Conferences

NFC_East_data <- NFL_raw %>%
  filter(team %in% c("DAL", "NYG", "PHI", "WAS"))%>%
  mutate(Conf = 'NFC_East')

NFC_West_data <- NFL_raw %>%
  filter(team %in% c("LA", "SEA", "SF", "ARI"))%>%
  mutate(Conf = 'NFC_West')

NFC_North_data <- NFL_raw %>%
  filter(team %in% c("CHI", "GB", "DET", "MIN"))%>%
  mutate(Conf = 'NFC_North')

NFC_South_data <- NFL_raw %>%
  filter(team %in% c("TB", "CAR", "ATL", "NO"))%>%
  mutate(Conf = 'NFC_South')

AFC_East_data <- NFL_raw %>%
  filter(team %in% c("NE", "BUF", "MIA", "NYJ"))%>%
  mutate(Conf = 'AFC_East')

AFC_West_data <- NFL_raw %>%
  filter(team %in% c("DEN", "LAC", "KC", "LV"))%>%
  mutate(Conf = 'AFC_West')

AFC_North_data <- NFL_raw %>%
  filter(team %in% c("BAL", "PIT", "CIN", "CLE"))%>%
  mutate(Conf = 'AFC_North')

AFC_South_data <- NFL_raw %>%
  filter(team %in% c("JAX", "IND", "HOU", "TEN"))%>%
  mutate(Conf = 'AFC_South')

NFL_Clean <- bind_rows(NFC_East_data, NFC_North_data, NFC_South_data, NFC_West_data, AFC_East_data, AFC_South_data, AFC_North_data, AFC_West_data) %>%
  arrange(season, team)%>%
    separate_wider_delim(
    cols = 'Conf',
    delim = '_',
    names = c('Conf', 'Div')
  )

```

## Offensive and Defensive Association with Wins
### Scatterplot of Win associations
In @fig-Win-association the y-axis has the wins that range from 0 to 16 and a linear regression line that wins with four different variables. In Wins Compared to Offensive Pass Yards the x-axis is the Offensive Pass Yards that range from 1000 to 6000. There is a positive linear association between wins and offensive pass yards which shows that as teams pass for more yards in a season they tend to win more games. In Wins Compared to Offensive Run Yards the x-axis is offensive run yards that range from 1000 to 4000 yards. There is a slightly stronger positive linear association between offensive run yards per seasons and offensive pass yards. This leads us to believe that it is slightly more important for teams to focus on good run offense then pass offense. Wins Compared to Defensive Allowed Pass Yards has defensive allowed pass yards as the x-axis with a range of 2000 to 5000 yards. There is a slightly negative linear association between defensive allowed pass yards and team wins. In Wins Compared to Defensive Allowed Run Yards the x-axis is defensive allowed run yards with a range from 500 to 3000 yards. There is a relatively strong negative linear association between defensive run yards allowed and team wins in a season. This leads us to believe that it is much more important to focus on run defense than pass defense as that would lead to more wins. In @fig-Win-association the colors are sorted by AFC and NFC teams for all of the graphs. In @fig-Win-association it seems to be more important to focus on both run offense and run defense to lead to more wins. It is definitely more important to focus on run defense then it is to focus on pass defense. This could be because a strong game allows a team to control the clock and have more possession time then the other team as every run play uses the clock.


```{r, fig.height=5, fig.width=10}
#| label: fig-Win-association
#| fig-cap: "Win Association of Offensive and Defensive Pass Yards"
#| fig-alt: "Four scatter plots showing NFL data, with axes for wins and various yard metrics. Trend lines suggest correlations."

#author: Timothy Smith
#reviewed: Isaac Swope

plot1<-NFL_Clean%>%
  group_by(Div)%>%
ggplot(# Step 1: Create the first graph using ggplot and geom point with x as offense pass yards and y as wins with colors being conference----
    mapping = aes(
      x = offense_total_yards_gained_pass,
      y = wins,
      color = Conf
    )#Step 2: Make the points size 1 and the transparency to be .2 ----
  ) +
  geom_point(size = 1, alpha=0.2) +
  labs(#Step 3: add labels and title to the data visualization and create the colors for the points----
    x = "Offensive Pass Yards",
    y = "Wins",
    color = "Conference",
    title = "Wins Compared to Offensive Pass Yards"
  ) +
  scale_color_manual(
    values = c("red", "blue")
  )+
  theme_bw() +
  theme(
    legend.position = "bottom"
  )+
  geom_smooth(method = "lm", se = FALSE, color = "black") 
# Step 4: Create the regression line ----
  plot2<-NFL_Clean%>%
  group_by(Div)%>%
ggplot(# Step 5: Repeat Step 1 but x is the total rush yards----
    mapping = aes(
      x = offense_total_yards_gained_run,
      y = wins,
      color = Conf
    )#Step 6: repeat step 2 for the second plot ----
  ) +
  geom_point(size=1, alpha=0.2) +
  labs(#Step 7: repeat step 3 for the second plot----
    x = "Offensive Run Yards",
    y = "Wins",
    color = "Conference",
    shape = "team",
    title = "Wins Compared to Offensive Run Yards"
  ) +
  scale_color_manual(
    values = c("red", "blue")
  )+
  theme_bw() +
  theme(
    legend.position = "bottom"
  )+
  geom_smooth(method = "lm", se = FALSE, color = "black") 
  #Step 8: Repeat step 4 for second plot----
  plot3<-NFL_Clean%>%
  group_by(Div)%>%
ggplot(#Step 9: Repeat step 1 but with x as the defensive allowed pass yards ----
    mapping = aes(
      x = defense_total_yards_gained_pass,
      y = wins,
      color = Conf
    )#Step 10: Repeat step 2 but for third plot----
  ) +
  geom_point(size=1, alpha=0.2) +
  labs(#Step 11: repeat step 3 but for third plot----
    x = "Defensive Allowed Pass Yards",
    y = "Wins",
    color = "Conference",
    title = "Wins Compared to Defensive Allowed Pass Yards"
  ) +
  scale_color_manual(
    values = c("red", "blue")
  )+
  theme_bw() +
  theme(
    legend.position = "bottom"
  )+
  geom_smooth(method = "lm", se = FALSE, color = "black") 
  #Step 12: repeat step 4 but for third plot----

  plot4<-NFL_Clean%>%
  group_by(Div)%>%
ggplot(#Step 13: repeat step 1 but x is the allowed rush yards----
    mapping = aes(
      x = defense_total_yards_gained_run,
      y = wins,
      color = Conf
    )# Step 14: repeat step 2 but for fourth plot----
  ) +
  geom_point(size=1, alpha=0.2) +
  labs(#Step 15: repeat step 3 but for fourth plot----
    x = "Defensive Allowed Run Yards",
    y = "Wins",
    color = "Conference",
    title = "Wins Compared to Defensive Allowed Run Yards"
  ) +
  scale_color_manual(
    values = c("red", "blue")
  )+
  theme_bw() +
  theme(
    legend.position = "bottom"
  )+
  geom_smooth(method = "lm", se = FALSE, color = "black") 
#Step 16: repeat step 4 but for fourth plot----
  
  ggarrange(plot1, plot2, plot3, plot4, nrow = 2, ncol = 2, common.legend = TRUE, legend = "bottom" )
  
#Step 17: create a grid with all of the plots together----


```
### Average Wins and Offensive and Defensive Yards Table

@tbl-O-D-Statistics includes the average team wins, the 32 NFL teams, average Offensive pass yards, average offensive rush yards, average defensive rush yards, and average defensive pass yards. The defensive statistics is the average amount of yards that the defense allowed so the lower the number the better the team is in that particular stat. The team with the most average wins in the patriots which makes sense as they had one of the biggest dynasties in NFL history. What is interesting about this is that they had the highest wins, but in every other category there was at least one team that performed better then them. The highest average offensive pass yards belonged to New Orleans which is 9th in the average wins statistic. The highest average rush yards belongs and lowest allowed rush yards belongs to Baltimore which is 5th in average wins. Buffalo has the lowest allowed pass yards and they are 17th in average wins. This shows that the best team is not the best in each category so it must be a combination of these things that lead to winning football. Cleveland does have the lowest average wins and lowest average allowed rush yards so there could be a stronger correlation with losing and have a bad rush defense which is also supported in @fig-Win-association

```{r}
#| label: tbl-O-D-Statistics 
#| tbl-cap: "NFL Offensive and Defensive Statistics"

#author: Timothy Smith
#reviewed: Isaac Swope

NFL_O_D <- NFL_Clean %>%
  group_by(team)%>%
  summarize(#Step 1: Determine the average values of the 5 main statistics that I want to work on and arrange by the Average Team Wins----
    Mean_Wins = mean(wins, na.rm = TRUE),
    Mean_O_pass_yards = mean(offense_total_yards_gained_pass, na.rm = TRUE),
    Mean_O_run_yards = mean(offense_total_yards_gained_run, na.rm = TRUE),
    Mean_D_pass_yards = mean(defense_total_yards_gained_pass, na.rm = TRUE),
    Mean_D_run_yards = mean(defense_total_yards_gained_run, na.rm = TRUE)
  ) %>%
  arrange(desc(Mean_Wins))
    
    names(NFL_O_D) <- c(#Step 2: replace the Names of the columns----
    "Teams",
    "Average Wins",
    "Mean Offensive Pass Yards",
    "Mean Offense Run Yards",
    "Mean Defensive Pass Yards",
    "Mean Defensive Run Yards"
    )
  
NFL_O_D %>%
  kable(#Step 3: Create the table using the kable function----
    booktabs = TRUE,
    align = c("l", rep("c",10)))

```

## Team Wins from 1999-2022

When people think of the best football team of all time, to many, the first thing to come to mind is wins. In this section we will look at a visualization and some statistics to build an understanding of team wins in the 21st century.

First we have simple box plots @fig-team-wins showing every NFL team's total wins since from 1999-2022. The box plots are separated and colored so one can more easily compare within divisions and across the conferences. Note the thin white lines, which show how the wins are summed up by season. An interesting observation is that it seams as though teams with more wins were also more consistent across seasons as the distance between white lines does not vary as much as those in teams with less overall wins. This is a observed trend which can be made by looking at the figure, but it will not be shown to be statistically significant in this section, whether or not it truly is.

```{r, fig.width=8}
#| label: fig-team-wins
#| fig-cap: "Boxplots of Team Wins"
#| fig-alt: "Grid of four barcharts showing total team wins separated by division"

#author: Isaac Swope
#reviewed: Kyle Barber

#we need to sum and order by wins so we use fct_reorder and then .desc=TRUE to force descending order.
ggplot(NFL_Clean) +
  aes(x = fct_reorder(team, wins, .fun=sum, .desc=TRUE), y = wins, fill = Conf) +
  geom_col(color = NA) +
  facet_wrap("Div", scales = "free") + #eliminate spacing between columns due to scale
  labs(y = "Wins", 
       x = "Teams",
       )
  
```


Now it would be appropriate to provide a table showing statistics for wins by season. The  following table @tbl-win-stats gives seasons played from 1999-2022, minimum wins in a season, first quartile, median wins, third quartile, maximum wins in a season, simple arithmetic mean of wins, and standard deviation for each team. One thing to note is that Houston has played three seasons less than the other teams, as they joined the NFL in the 2002 season. Standard deviation represented by SD is the how much a team's amount of wins usually varies from season to season. 


```{r}
#| label: tbl-win-stats
#| tbl-cap: "Team Wins Statistics"
#| html-table-processing: none

#author: Isaac Swope
#reviewed: Timothy Smith

winsTable <- NFL_Clean %>%
  group_by(team)%>% #we want to group by team
  summarize( # calculating the selected statistics
    Count=n(),
    Min = min(wins, na.rm = TRUE),
    Quartile_1 = quantile(wins, probs = 0.25, na.rm = TRUE),
    Median = median(wins, na.rm = TRUE),
    Quintile_3 = quantile(wins, probs = 0.75, na.rm = TRUE),
    Max = max(wins, na.rm = TRUE),
    Mean = mean(wins, na.rm = TRUE),
    SD = sd(wins, na.rm = TRUE),
  )%>%
  mutate(
    across(
      .cols = where(is.numeric),
      .fns = ~round(.x, digits = 2) #rounding to 2 decimal places
    )
  )

names(winsTable) <- c( #renaming columns
    "Team",
    "Seasons",
    "Minimum",
    "Quartile 1",
    "Median",
    "Quartile 3",
    "Max",
    "Mean",
    "SD"
    )
  
winsTable %>%
  kable(
    booktabs = TRUE,
    align = c("l", rep("c",10))
  )

```


## Team Efficiency


```{r}
#| label: fig-effeciency-scatter-plot
#| fig-cap: NFL Team Effeciency Scatter Plot
#| fig-alt: "Scatter plot of NFL teams' points scored versus points allowed for AFC and NFC teams."
NFL_Clean_3 <- NFL_Clean %>%
  select(team, Conf, score_differential, points_scored,
         points_allowed, wins, losses) %>%
  group_by(team, Conf) %>%
  summarise(
    points_scored = mean(points_scored),
    points_allowed = mean(points_allowed),
    wins = mean(wins),
    losses = mean(losses),
    point_differential = mean(score_differential),
    .groups = "drop"
  )
NFL_Clean_3$logo <- paste0("Logos/", NFL_Clean_3$team, ".png")

ggplot(NFL_Clean_3) +
  aes(x = points_allowed, y = points_scored) +
  geom_point(size = 0.1) +
  geom_image(aes(image = logo)) +
  labs(
    x = "Points Allowed (per season)",
    y = "Points Scored (per season)"
  ) +
  geom_abline(slope = 1, intercept = 0) +
  theme_minimal() +
  facet_wrap(vars(Conf))

```

```{r}
#| label: tbl-effeciency-scatter-plot-AFC
#| tbl-cap: "AFC Effeciency tables"

AFC_table <- NFL_Clean_3%>%
  filter(Conf == 'AFC')%>%
  select(team, point_differential, wins, losses, logo)%>%
  mutate(
    point_differential = round(point_differential, digits = 4),
    wins = round(wins, digits = 4),
    losses = round(losses, digits = 4),
    image = ""
  )%>%
  arrange(desc(wins)) %>%
  rename(
    Team = team,
    `Average Point Differential` = point_differential,
    `Win Rate` = wins,
    `Loss Rate` = losses
  )

AFC_table %>%
  select(Team, image, `Average Point Differential`, `Win Rate`, `Loss Rate`) %>%
  kable(
    booktabs = TRUE,
    align = c("l", rep("c", 10)),
    format = "latex"
  )%>%
  kable_paper()%>%
  column_spec(2, image = spec_image(path = AFC_table$logo, 50, 50))

```

```{r}
#| label: tbl-effeciency-scatter-plot-NFC
#| tbl-cap: "NFC Effeciency tables"

NFC_table <- NFL_Clean_3%>%
  filter(Conf == 'NFC')%>%
  select(team, point_differential, wins, losses, logo)%>%
  mutate(
    point_differential = round(point_differential, digits = 4),
    wins = round(wins, digits = 4),
    losses = round(losses, digits = 4),
    image = ""
  )%>%
  arrange(desc(wins)) %>%
  rename(
    Team = team,
    `Average Point Differential` = point_differential,
    `Win Rate` = wins,
    `Loss Rate` = losses
  )

NFC_table %>%
  select(Team, image, `Average Point Differential`, `Win Rate`, `Loss Rate`) %>%
  kable(
    booktabs = TRUE,
    align = c("l", rep("c", 10)),
    format = "latex"
  )%>%
  kable_paper()%>%
  column_spec(2, image = spec_image(path = AFC_table$logo, 50, 50))

```

{{< pagebreak >}}
#Code Appendix
``` {r codeAppend, ref.label=knitr::all_labels(), echo=TRUE, eval=FALSE}

```
