---
title: "NFL_Data_Analysis"
authors: 
  - name: Isaac Swope
  - name: Kyle Barber
  - name: Tim Smith
date: "Dec 3, 2025"
date_modified: "Dec 3, 2025"
execute:
  warning: false
  error: false
  echo: false
format:
  pdf:
    embed-resources: true
    geometry: margin=1in
    fig-cap-location: top
    tbl-cap-location: top
---

```{r}
#|label: Packages

#Tidyverse Coding Styling
library(tidyverse)
library(ggimage)
library(kableExtra)

```

## Data Overview

```{r}
#|label: Importing Data

NFL_raw <- read.csv("nfl-team-statistics (1).csv")

```


```{r}
#|label: Adding East, West, North and South Conferences
NFC_East_data <- NFL_raw %>%
  filter(team %in% c("DAL", "NYG", "PHI", "WAS"))%>%
  mutate(Conf = 'NFC_East')

NFC_West_data <- NFL_raw %>%
  filter(team %in% c("LA", "SEA", "SF", "ARI"))%>%
  mutate(Conf = 'NFC_West')

NFC_North_data <- NFL_raw %>%
  filter(team %in% c("CHI", "GB", "DET", "MIN"))%>%
  mutate(Conf = 'NFC_North')

NFC_South_data <- NFL_raw %>%
  filter(team %in% c("TB", "CAR", "ATL", "NO"))%>%
  mutate(Conf = 'NFC_South')

AFC_East_data <- NFL_raw %>%
  filter(team %in% c("NE", "BUF", "MIA", "NYJ"))%>%
  mutate(Conf = 'AFC_East')

AFC_West_data <- NFL_raw %>%
  filter(team %in% c("DEN", "LAC", "KC", "LV"))%>%
  mutate(Conf = 'AFC_West')

AFC_North_data <- NFL_raw %>%
  filter(team %in% c("BAL", "PIT", "CIN", "CLE"))%>%
  mutate(Conf = 'AFC_North')

AFC_South_data <- NFL_raw %>%
  filter(team %in% c("JAX", "IND", "HOU", "TEN"))%>%
  mutate(Conf = 'AFC_South')

NFL_Clean <- bind_rows(NFC_East_data, NFC_North_data, NFC_South_data, NFC_West_data, AFC_East_data, AFC_South_data, AFC_North_data, AFC_West_data) %>%
  arrange(season, team)%>%
    separate_wider_delim(
    cols = 'Conf',
    delim = '_',
    names = c('Conf', 'Div')
  )

```

## Effeciency Scatterplot
```{r}
#|label: fig-effeciency-scatter-plot
#|fig-cap:
#|fig-alt:
#|fig-pos: "H"
# Raw graph code
NFL_Clean_3 <- NFL_Clean %>%
  select(team, Conf, score_differential, points_scored,
         points_allowed, wins, losses) %>%
  group_by(team, Conf) %>%
  summarise(
    points_scored = mean(points_scored),
    points_allowed = mean(points_allowed),
    wins = mean(wins),
    losses = mean(losses),
    point_differential = mean(score_differential),
    .groups = "drop"
  )
NFL_Clean_3$logo <- paste0("Logos/", NFL_Clean_3$team, ".png")

slope_and_intercept <- lm(points_allowed ~ points_scored, data = NFL_Clean_3)

ggplot(NFL_Clean_3) +
  aes(x = points_allowed, y = points_scored) +
  geom_point(size = 0.1) +
  #geom_image(aes(image = logo)) +
  scale_color_hue(direction = 1) +
  labs(
    title = "Team Effeciency",
    x = "Points Allowed (per season)",
    y = "Points Scored (per season)"
  ) +
  #Need to fix slope and intercept
  geom_abline(slope = 1, intercept = 0) +
  theme_minimal() +
  facet_wrap(vars(Conf))
```

## Effeciency Tables
```{r}
#|label: tbl-effeciency-scatter-plot
#|fig-cap:
#|fig-alt:
#|fig-pos: "H"
AFC_table <- NFL_Clean_3%>%
  filter(Conf == 'AFC')%>%
  select(team, point_differential, wins, losses)%>%
  mutate(
    point_differential = round(point_differential, digits = 4),
    wins = round(wins, digits = 4),
    losses = round(losses, digits = 4)
  )%>%
  arrange(desc(wins))%>%
  kable(caption = "AFC Team Effeciency",
        booktabs = TRUE,
        align = c("l", rep("c", 10)))

NFC_table <- NFL_Clean_3%>%
  filter(Conf == 'NFC')%>%
  select(team, point_differential, wins, losses)%>%
  mutate(
    point_differential = round(point_differential, digits = 4),
    wins = round(wins, digits = 4),
    losses = round(losses, digits = 4)
  )%>%
  arrange(desc(wins))%>%
  kable(caption = "NFC Team Effeciency",
        booktabs = TRUE,
        align = c("l", rep("c", 10)))

```

{{< pagebreak >}}
Code Appendix
``` {r codeAppend, ref.label=knitr::all_labels(), echo=TRUE, eval=FALSE}

```
